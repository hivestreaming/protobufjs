steps:
  - task: NodeTool@0
    displayName: Install Node.js
    inputs:
      versionSpec: 16.x
  - script: |
      # Required to avoid errors when also pulling from Nexus
      rm -f .npmrc
      SECRET=$(echo -n "$NEXUS_USERNAME:$NEXUS_PASSWORD" | base64)
      echo "//nexus.devops.hivestreaming.net/repository/npm-group/:_auth=${SECRET}" > $HOME/.npmrc
      echo "//nexus.devops.hivestreaming.net/repository/:_auth=${SECRET}" >> $HOME/.npmrc
    displayName: Npm Registry
    env:
      NEXUS_USERNAME: $(nexus-username)
      NEXUS_PASSWORD: $(nexus-password)
  - script: npm ci
    displayName: Npm Install